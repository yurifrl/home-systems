# curl -X POST http://alertmanager.syscd.tech/-/reload -v   
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: alertmanager-config
  namespace: default
  labels:
    prometheus: k8s
    role: alert-rules
spec:
  route:
    receiver: discord
    groupBy:
      - alertname
    groupWait: 30s
    groupInterval: 5m
    repeatInterval: 1h
    routes:
      - receiver: 'discord'
        matchers:
          - name: alertname
            value: TargetDown
        continue: true
  receivers:
    - name: 'discord'
      webhookConfigs:
        - urlSecret:
            name: alertmanager-discord
            key: webhook-url
    - name: 'null'
---
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: config-example
  namespace: default
  labels:
    alertmanagerConfig: example
spec:
  route:
    groupBy: ['job']
    groupWait: 30s
    groupInterval: 5m
    repeatInterval: 12h
    receiver: 'webhook'
  receivers:
  - name: 'webhook'
    webhookConfigs:
    - url: 'http://example.com/'
# ---
# apiVersion: monitoring.coreos.com/v1
# kind: PrometheusRule
# metadata:
#   name: test-alert
#   namespace: monitoring  # Replace with your Prometheus namespace
#   labels:
#     prometheus: k8s
#     role: alert-rules
# spec:
#   groups:
#     - name: test-alert-group
#       rules:
#         - alert: TestAlert
#           expr: vector(1)  # Always triggers
#           for: 1m
#           labels:
#             severity: critical
#           annotations:
#             summary: "Test Alert is firing!"
#             description: "This is a test alert to verify the Alertmanager configuration."


# https://devopscube.com/setup-prometheus-operator/
# https://medium.com/@phil16terpasetheo/configure-alert-manager-with-slack-notifications-on-kubernetes-cluster-helm-kube-prometheus-stack-112878c35f26