{{- range $i, $inst := .Values.instances | default (list) }}
{{- $name := $inst.name }}
{{- $enabled := default true $inst.enabled }}
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: echotube-cache-{{ $name }}
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: {{ $.Values.cache.size | default "1Gi" }}
{{- with $.Values.cache.storageClassName }}
  storageClassName: {{ . }}
{{- end }}
{{- if not $enabled }}
---
{{- end }}
---
{{- end }}

