apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: terraform-drift-detection-
  namespace: argo-workflows
spec:
  serviceAccountName: terraform-drift-detection
  entrypoint: main
  ttlStrategy:
    secondsAfterSuccess: 1800
  artifactGC:
    strategy: OnWorkflowDeletion # OnWorkflowCompletion # default OnWorkflowDeletion
  templates:
    - name: main
      steps:
        - - name: git-clone
            template: git-clone
        - - name: terraform-drift-detection
            template: terraform-drift
            arguments:
              artifacts:
                - name: git-clone
                  from: "{{steps.git-clone.outputs.artifacts.git-clone}}"
                                    