apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: bind9-mesh
spec:
  hosts:
    - bind9.bind9.svc.cluster.local
  gateways:
    - mesh
  tcp:
  - match:
    - port: 53
    route:
    - destination:
        host: bind9.bind9.svc.cluster.local
        port:
          number: 53
        weight: 100
        headers:
          response:
            add:
              x-served-by: "istio-vs"
# ---
# apiVersion: networking.istio.io/v1alpha3
# kind: DestinationRule
# metadata:
#   name: bind9
# spec:
#   host: bind9
#   subsets:
#   - name: v1
#     labels:
#       instance: "1"
#   - name: v2
#     labels:
#       instance: "2"
#   - name: v3
#     labels:
#       instance: "3" 