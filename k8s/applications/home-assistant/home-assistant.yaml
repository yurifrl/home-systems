---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: home-assistant
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://andrenarchy.github.io/helm-charts
    chart: home-assistant
    targetRevision: "*"
    helm:
      valuesObject:
        env:
          TZ: "America/Sao_Paulo"
        hostNetwork: true
        # # probes:
        # #   liveness:
        # #     enabled: false
        # #   readiness:
        # #     enabled: false
        # #   startup:
        # #     enabled: true
        # persistence:
        #   config:
        #     enabled: false
        #     # storageClass: "longhorn"
        #     # accessMode: ReadWriteOnce
        #     # size: "10Gi"
        #     # annotations:
        #     #   recurring-job-group.longhorn.io/default: enabled
        # addons:
        #   codeserver:
        #     enabled: true
        #     # image:
        #     #   repository: codercom/code-server
        #     #   tag: 3.12.0
        #     # workingDir: "/config"
        #     # args:
        #     #   - --user-data-dir
        #     #   - "/config/.vscode"
        #     #   - --auth
        #     #   - "none"
        #     # volumeMounts:
        #     #   - name: config
        #     #     mountPath: /config
        # # tolerations:
        # #   - key: "arm"
        # #     operator: "Exists"
        # resources:
        #   limits:
        #     memory: 2500Mi
        #   requests:
        #     cpu: 100m
        #     memory: 1000Mi
        # postgresql:
        #   enabled: true
        #   postgresqlUsername: home-assistant
        #   postgresqlDatabase: home-assistant
        #   persistence:
        #     enabled: false
        #     # storageClass: "longhorn"
        #     # annotations:
        #     #   recurring-job-group.longhorn.io/default: enabled
        #   # volumePermissions:
        #   #   enabled: true
        #   #   image:
        #   #     repository: bitnami/minideb
        #   #     tag: buster-arm64

  destination:
    server: https://kubernetes.default.svc
    namespace: home-assistant
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
